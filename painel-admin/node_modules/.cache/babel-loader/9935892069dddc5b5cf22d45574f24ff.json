{"remainingRequest":"C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\src\\modules\\auth\\store\\actions.js","dependencies":[{"path":"C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\src\\modules\\auth\\store\\actions.js","mtime":1612449622828},{"path":"C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1612449484248},{"path":"C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1612449483050},{"path":"C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\node_modules\\eslint-loader\\index.js","mtime":1612449489577}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\victo\\\\Documents\\\\GitHub\\\\miv-front-end\\\\painel-admin\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport services from '@/http';\nimport * as storage from \"../storage\";\nimport * as types from \"./mutation-types\";\nexport var ActionDoLogin = function ActionDoLogin(_ref, payload) {\n  var dispatch = _ref.dispatch;\n  return services.auth.login(payload).then(function (res) {\n    dispatch('ActionSetUser', res.data.user);\n    dispatch('ActionSetToken', res.data.token);\n  });\n};\nexport var ActionCheckToken = function ActionCheckToken(_ref2) {\n  var dispatch = _ref2.dispatch,\n      state = _ref2.state;\n\n  if (state.token) {\n    return Promise.resolve(state.token);\n  }\n\n  var token = storage.getLocalToken();\n\n  if (!token) {\n    return Promise.reject(new Error('Token Inválido'));\n  }\n\n  dispatch('ActionSetToken', token);\n  return dispatch('ActionLoadSession');\n};\nexport var ActionLoadSession = function ActionLoadSession(_ref3) {\n  var dispatch = _ref3.dispatch;\n  return new Promise(\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee(resolve, reject) {\n      var _ref5, user;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return services.auth.loadSession();\n\n            case 3:\n              _ref5 = _context.sent;\n              user = _ref5.data.user;\n              dispatch('ActionSetUser', user);\n              resolve();\n              _context.next = 13;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              dispatch('ActionSignOut');\n              reject(_context.t0);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 9]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }());\n};\nexport var ActionSetUser = function ActionSetUser(_ref6, payload) {\n  var commit = _ref6.commit;\n  commit(types.SET_USER, payload);\n};\nexport var ActionSetToken = function ActionSetToken(_ref7, payload) {\n  var commit = _ref7.commit;\n  storage.setLocalToken(payload);\n  storage.setHeaderToken(payload);\n  commit(types.SET_TOKEN, payload);\n};\nexport var ActionSignOut = function ActionSignOut(_ref8) {\n  var dispatch = _ref8.dispatch;\n  storage.setHeaderToken('');\n  storage.deleteLocalToken();\n  dispatch('ActionSetUser', {});\n  dispatch('ActionSetToken', '');\n};",{"version":3,"sources":["C:\\Users\\victo\\Documents\\GitHub\\miv-front-end\\painel-admin\\src\\modules\\auth\\store\\actions.js"],"names":["services","storage","types","ActionDoLogin","payload","dispatch","auth","login","then","res","data","user","token","ActionCheckToken","state","Promise","resolve","getLocalToken","reject","Error","ActionLoadSession","loadSession","ActionSetUser","commit","SET_USER","ActionSetToken","setLocalToken","setHeaderToken","SET_TOKEN","ActionSignOut","deleteLocalToken"],"mappings":";;AAAA,OAAOA,QAAP,MAAqB,QAArB;AACA,OAAO,KAAKC,OAAZ;AACA,OAAO,KAAKC,KAAZ;AAEA,OAAO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,OAAeC,OAAf,EAA2B;AAAA,MAAxBC,QAAwB,QAAxBA,QAAwB;AACtD,SAAOL,QAAQ,CAACM,IAAT,CAAcC,KAAd,CAAoBH,OAApB,EAA6BI,IAA7B,CAAkC,UAAAC,GAAG,EAAI;AAC9CJ,IAAAA,QAAQ,CAAC,eAAD,EAAkBI,GAAG,CAACC,IAAJ,CAASC,IAA3B,CAAR;AACAN,IAAAA,QAAQ,CAAC,gBAAD,EAAmBI,GAAG,CAACC,IAAJ,CAASE,KAA5B,CAAR;AACD,GAHM,CAAP;AAID,CALM;AAOP,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,QAAyB;AAAA,MAAtBR,QAAsB,SAAtBA,QAAsB;AAAA,MAAZS,KAAY,SAAZA,KAAY;;AACvD,MAAIA,KAAK,CAACF,KAAV,EAAiB;AACf,WAAOG,OAAO,CAACC,OAAR,CAAgBF,KAAK,CAACF,KAAtB,CAAP;AACD;;AAED,MAAMA,KAAK,GAAGX,OAAO,CAACgB,aAAR,EAAd;;AAEA,MAAI,CAACL,KAAL,EAAY;AACV,WAAOG,OAAO,CAACG,MAAR,CAAe,IAAIC,KAAJ,CAAU,gBAAV,CAAf,CAAP;AACD;;AAEDd,EAAAA,QAAQ,CAAC,gBAAD,EAAmBO,KAAnB,CAAR;AACA,SAAOP,QAAQ,CAAC,mBAAD,CAAf;AACD,CAbM;AAeP,OAAO,IAAMe,iBAAiB,GAAG,SAApBA,iBAAoB,QAAkB;AAAA,MAAff,QAAe,SAAfA,QAAe;AACjD,SAAO,IAAIU,OAAJ;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAY,iBAAOC,OAAP,EAAgBE,MAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEkBlB,QAAQ,CAACM,IAAT,CAAce,WAAd,EAFlB;;AAAA;AAAA;AAECV,cAAAA,IAFD,SAEPD,IAFO,CAECC,IAFD;AAGfN,cAAAA,QAAQ,CAAC,eAAD,EAAkBM,IAAlB,CAAR;AACAK,cAAAA,OAAO;AAJQ;AAAA;;AAAA;AAAA;AAAA;AAMfX,cAAAA,QAAQ,CAAC,eAAD,CAAR;AACAa,cAAAA,MAAM,aAAN;;AAPe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAZ;;AAAA;AAAA;AAAA;AAAA,MAAP;AAUD,CAXM;AAaP,OAAO,IAAMI,aAAa,GAAG,SAAhBA,aAAgB,QAAalB,OAAb,EAAyB;AAAA,MAAtBmB,MAAsB,SAAtBA,MAAsB;AACpDA,EAAAA,MAAM,CAACrB,KAAK,CAACsB,QAAP,EAAiBpB,OAAjB,CAAN;AACD,CAFM;AAIP,OAAO,IAAMqB,cAAc,GAAG,SAAjBA,cAAiB,QAAarB,OAAb,EAAyB;AAAA,MAAtBmB,MAAsB,SAAtBA,MAAsB;AACrDtB,EAAAA,OAAO,CAACyB,aAAR,CAAsBtB,OAAtB;AACAH,EAAAA,OAAO,CAAC0B,cAAR,CAAuBvB,OAAvB;AACAmB,EAAAA,MAAM,CAACrB,KAAK,CAAC0B,SAAP,EAAkBxB,OAAlB,CAAN;AACD,CAJM;AAMP,OAAO,IAAMyB,aAAa,GAAG,SAAhBA,aAAgB,QAAkB;AAAA,MAAfxB,QAAe,SAAfA,QAAe;AAC7CJ,EAAAA,OAAO,CAAC0B,cAAR,CAAuB,EAAvB;AACA1B,EAAAA,OAAO,CAAC6B,gBAAR;AACAzB,EAAAA,QAAQ,CAAC,eAAD,EAAkB,EAAlB,CAAR;AACAA,EAAAA,QAAQ,CAAC,gBAAD,EAAmB,EAAnB,CAAR;AACD,CALM","sourcesContent":["import services from '@/http'\r\nimport * as storage from '../storage'\r\nimport * as types from './mutation-types'\r\n\r\nexport const ActionDoLogin = ({ dispatch }, payload) => {\r\n  return services.auth.login(payload).then(res => {\r\n    dispatch('ActionSetUser', res.data.user)\r\n    dispatch('ActionSetToken', res.data.token)\r\n  })\r\n}\r\n\r\nexport const ActionCheckToken = ({ dispatch, state }) => {\r\n  if (state.token) {\r\n    return Promise.resolve(state.token)\r\n  }\r\n\r\n  const token = storage.getLocalToken()\r\n\r\n  if (!token) {\r\n    return Promise.reject(new Error('Token Inválido'))\r\n  }\r\n\r\n  dispatch('ActionSetToken', token)\r\n  return dispatch('ActionLoadSession')\r\n}\r\n\r\nexport const ActionLoadSession = ({ dispatch }) => {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const { data: { user } } = await services.auth.loadSession()\r\n      dispatch('ActionSetUser', user)\r\n      resolve()\r\n    } catch (err) {\r\n      dispatch('ActionSignOut')\r\n      reject(err)\r\n    }\r\n  })\r\n}\r\n\r\nexport const ActionSetUser = ({ commit }, payload) => {\r\n  commit(types.SET_USER, payload)\r\n}\r\n\r\nexport const ActionSetToken = ({ commit }, payload) => {\r\n  storage.setLocalToken(payload)\r\n  storage.setHeaderToken(payload)\r\n  commit(types.SET_TOKEN, payload)\r\n}\r\n\r\nexport const ActionSignOut = ({ dispatch }) => {\r\n  storage.setHeaderToken('')\r\n  storage.deleteLocalToken()\r\n  dispatch('ActionSetUser', {})\r\n  dispatch('ActionSetToken', '')\r\n}\r\n"]}]}